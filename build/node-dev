#!/usr/bin/env node

/**
 * 1. start backend node to dev mode,
 * if some js code changes,
 * node-dev will hard(not soft) restart the server
 * 2. open browser on free port, default is 8000
 * */
// var opn = require('opn')
var portfinder = require('portfinder')
var {exec} = require('shelljs')

portfinder.getPortPromise()
.then((port) => {
  console.log(`---------------------------------------------`)
  console.log(` Server will start at: http://localhost:${port}`)
  console.log(`---------------------------------------------`)
  process.env.PORT = port

  // opn('http://localhost:' + port)

  exec('node-dev ./bin/www')
})
.catch(function (err) {
  //
  // Could not get a free port, `err` contains the reason.
  //
})
